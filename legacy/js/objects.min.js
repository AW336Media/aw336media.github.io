CM.objects.add3dtext=function(){var n={type:1,threeObj:null,keyframeProps:{position:[{frame:1,value:[0,0,0],tweenfn:null}],rotation:[{frame:1,value:[0,0,0],tweenfn:null}],scale:[{frame:1,value:[1,1,1],tweenfn:null}]}};return n.save=function(){return $.extend({},{type:this.type,objectType:this.objectType,keyframeProps:this.keyframeProps,normalProps:this.normalProps,appearanceObj:this.appearanceObj,appearanceObjData:this.appearanceObj?CM.appearance.objects[this.appearanceObj].save(this.threeObj.material):null})},n.load=function(n){n?($.extend(!0,this,n),this.changeObjectType(this.objectType,!0)):this.changeObjectType(1)},n.unload=function(){CM.appearance.unload(this.appearanceObj);this.threeObj&&CM.scene.remove(this.threeObj)},n.updateFrame=function(){if(this.threeObj){var n=TWEEN.getValue(this.keyframeProps.position,CM.currentFrame);this.threeObj.position.set(n[0],n[1],n[2]);n=TWEEN.getValue(this.keyframeProps.rotation,CM.currentFrame);this.threeObj.rotation.set(n[0]*Math.PI/180,n[1]*Math.PI/180,n[2]*Math.PI/180);n=TWEEN.getValue(this.keyframeProps.scale,CM.currentFrame);this.threeObj.scale.set(n[0],n[1],n[2]);this.threeObj.material}},n.center=function(){this.threeObj.geometry.computeBoundingBox();var t=this.threeObj.geometry.boundingBox,n=new THREE.Vector3;n.addVectors(t.min,t.max);n.multiplyScalar(-.5);switch(this.normalProps.positionMode){case 1:n.x-=n.x;break;case 2:n.x+=n.x;break;case 3:n.y+=n.y;break;case 4:n.y-=n.y;break;case 5:n.z+=n.z;break;case 6:n.z-=n.z}this.threeObj.geometry.applyMatrix((new THREE.Matrix4).makeTranslation(n.x,n.y,n.z));this.threeObj.geometry.computeBoundingBox()},n.updateProps=function(){this.threeObj.geometry.dispose();switch(this.objectType){case 1:this.threeObj.geometry=new THREE.TextGeometry(this.normalProps.text,{size:this.normalProps.size[0],height:this.normalProps.size[1],curveSegments:this.normalProps.detail,font:this.normalProps.font,bevelEnabled:this.normalProps.bevel,bevelThickness:this.normalProps.bevelsize[0],bevelSize:this.normalProps.bevelsize[1],material:0,extrudeMaterial:1});this.threeObj.geometry.buffersNeedUpdate=!0;this.center()}},n.changeObjectType=function(n,t){t||(this.normalProps={});this.objectType=n;switch(this.objectType){case 1:t||(this.normalProps.size=[25,5],this.normalProps.detail=3,this.normalProps.bevel=!1,this.normalProps.bevelsize=[.1,.5],this.normalProps.font="bebas",this.normalProps.text="panzoid",this.normalProps.positionMode=0);var i=this;CM.loadFont(this.normalProps.font,function(){i.threeObj=new THREE.Mesh(new THREE.TextGeometry(i.normalProps.text,{size:i.normalProps.size[0],height:i.normalProps.size[1],curveSegments:i.normalProps.detail,font:i.normalProps.font,bevelEnabled:i.normalProps.bevel,bevelThickness:i.normalProps.bevelsize[0],bevelSize:i.normalProps.bevelsize[1],material:0,extrudeMaterial:1}),null);i.appearanceObj||(i.appearanceObj="singlecolor");i.threeObj.material=CM.appearance.load(i.appearanceObj);i.appearanceObjData&&(CM.appearance.objects[i.appearanceObj].load(i.appearanceObjData,i.threeObj.material),delete i.appearanceObjData);i.center();i.threeObj.castShadow=!0;i.threeObj.receiveShadow=!0;CM.scene.add(i.threeObj)});break;case 0:CM.appearance.unload(this.appearanceObj);this.appearanceObj=null;CM.scene.remove(this.threeObj);this.threeObj=null;return}},n.select=function(n){var t=this,i,r;PZeditor.generateTitle({title:"3D Text",location:n});PZeditor.generateTextInput({location:n,property:t.normalProps.text,updatefn:function(n){t.normalProps.text=n;t.updateProps()}});PZeditor.generateListPicker({location:n,property:t.normalProps.font,items:CM.fontList,updatefn:function(n){t.normalProps.font=n;CM.loadFont(n,function(){t.updateProps()})}});PZeditor.generateDualInput({title:"Size",location:n,keyframed:!1,subtitle1:"height",subtitle2:"thickness",property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n,i){t.normalProps.size[i]=n;t.updateProps()}});PZeditor.generateInput({title:"Detail",location:n,keyframed:!1,property:t.normalProps.detail,vmax:1e4,vmin:1,vstep:1,updatefn:function(n){t.normalProps.detail=n;t.updateProps()}});PZeditor.generateDropdown({title:"Bevel",location:n,keyframed:!1,property:Number(t.normalProps.bevel)+1,items:"false;true",updatefn:function(n){n==2?(t.normalProps.bevel=!0,i.show("blind",200)):(t.normalProps.bevel=!1,i.hide("blind",200));t.updateProps()}});i=PZeditor.generatePlaceholder({location:n});t.normalProps.bevel==!1&&i.hide();PZeditor.generateDualInput({title:"Bevel size",location:i,keyframed:!1,subtitle1:"size",subtitle2:"thickness",property:t.normalProps.bevelsize,vmax:1e4,vmin:0,vstep:1,updatefn:function(n,i){t.normalProps.bevelsize[i]=n;t.updateProps()}});PZeditor.generateSpacer({location:n});PZeditor.generateDropdown({title:"Center point",location:n,keyframed:!1,property:Number(t.normalProps.positionMode)+1,items:"center;left;right;top;bottom;front;back",updatefn:function(n){t.normalProps.positionMode=n-1;t.updateProps()}});PZeditor.generateTriInput({title:"Position",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.position,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateTriInput({title:"Rotation",color:"hsl(120, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.rotation,vmax:360,vmin:0,vstep:1});PZeditor.generateTriInput({title:"Scale",color:"hsl(240, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.scale,vmax:1e3,vmin:0,vstep:1});PZeditor.generateSpacer({location:n});PZeditor.generateDropdown({location:n,title:"Appearance",keyframed:!1,property:t.appearanceObj?CM.appearance.list[t.appearanceObj].index+1:1,items:CM.appearance.string,updatefn:function(n){CM.appearance.unload(t.appearanceObj);var i=0;for(prop in CM.appearance.list)if(i++,i==n){t.appearanceObj=prop;break}t.threeObj.material&&t.threeObj.material.dispose();t.threeObj.material=CM.appearance.load(t.appearanceObj);r.empty();CM.appearance.objects[t.appearanceObj].select(r,t.threeObj.material)}});r=PZeditor.generatePlaceholder({location:n});CM.appearance.objects[t.appearanceObj].select(r,t.threeObj.material);CM.timelineObjects.objects=t.keyframeProps;CM.updateFrameUI()},n};CM.basics={resolution:3};CM.basics.select=function(n){PZeditor.generateDropdown({location:n,title:"Resolution",property:CM.basics.resolution,updatefn:function(n){switch(n){case 1:CM.frameWidth=3840;CM.frameHeight=2160;break;case 2:CM.frameWidth=2560;CM.frameHeight=1440;break;case 3:CM.frameWidth=1920;CM.frameHeight=1080;break;case 4:CM.frameWidth=1280;CM.frameHeight=720;break;case 5:CM.frameWidth=854;CM.frameHeight=480;break;case 6:CM.frameWidth=640;CM.frameHeight=360;break;case 7:CM.frameWidth=426;CM.frameHeight=240}CM.basics.resolution=n;CM.aspect!=CM.frameWidth/CM.frameHeight&&(CM.aspect=CM.frameWidth/CM.frameHeight,CM.camera.aspect=CM.aspect,CM.camera.updateProjectionMatrix(),CM.resizeViewport())},items:"3840x2160 (2160p);2560x1440 (1440p);1920x1080 (1080p);1280x720 (720p);854x480 (480p);640x360 (360p);426x240 (240p)"});PZeditor.generateInput({location:n,title:"Length (seconds)",property:CM.totalFrames/CM.frameRate,updatefn:function(n){CM.totalFrames=Math.floor(n)*CM.frameRate;CM.currentFrame>CM.totalFrames&&(CM.currentFrame=CM.totalFrames);$("#frameslider").slider("option","max",CM.totalFrames);CM.updateFrameUI()},vmax:30,vmin:1,vstep:1})};CM.objects.addlight=function(){var n={type:3,threeObj:null,helper:null,objectType:0};return n.save=function(){return $.extend({},{type:this.type,objectType:this.objectType,keyframeProps:this.keyframeProps,normalProps:this.normalProps})},n.load=function(n){n?($.extend(!0,this,n),this.changeObjectType(this.objectType,!0)):this.changeObjectType(0)},n.unload=function(){this.threeObj&&CM.scene.remove(this.threeObj);this.helper&&CM.scene.remove(this.helper)},n.updateFrame=function(){if(this.threeObj){var n=TWEEN.getValue(this.keyframeProps.position,CM.currentFrame);this.threeObj.position.set(n[0],n[1],n[2]);this.keyframeProps.target&&(n=TWEEN.getValue(this.keyframeProps.target,CM.currentFrame),this.threeObj.target.position.set(n[0],n[1],n[2]));this.threeObj.intensity=TWEEN.getValue(this.keyframeProps.intensity,CM.currentFrame);this.keyframeProps.angle&&(this.threeObj.angle=TWEEN.getValue(this.keyframeProps.angle,CM.currentFrame)*Math.PI/180);this.keyframeProps.exponent&&(this.threeObj.exponent=TWEEN.getValue(this.keyframeProps.exponent,CM.currentFrame))}},n.changeObjectType=function(n,t){t||(this.keyframeProps={});this.objectType=n;switch(this.objectType){case 1:t||(this.keyframeProps.position=[{frame:1,value:[0,10,0],tweenfn:null}],this.keyframeProps.target=[{frame:1,value:[0,0,0],tweenfn:null}],this.keyframeProps.color=[{frame:1,value:[255,255,255],tweenfn:null}],this.keyframeProps.intensity=[{frame:1,value:1,tweenfn:null}],this.keyframeProps.angle=[{frame:1,value:60,tweenfn:null}],this.keyframeProps.exponent=[{frame:1,value:10,tweenfn:null}]);this.threeObj=new THREE.SpotLight(16777215,1,0,Math.PI/3,10);this.helper=new THREE.SpotLightHelper(this.threeObj,5);break;case 2:t||(this.keyframeProps.position=[{frame:1,value:[0,0,0],tweenfn:null}],this.keyframeProps.color=[{frame:1,value:[255,255,255],tweenfn:null}],this.keyframeProps.intensity=[{frame:1,value:1,tweenfn:null}]);this.threeObj=new THREE.PointLight(16777215,1,0);this.helper=new THREE.PointLightHelper(this.threeObj,5);break;case 3:t||(this.keyframeProps.position=[{frame:1,value:[0,10,0],tweenfn:null}],this.keyframeProps.target=[{frame:1,value:[0,0,0],tweenfn:null}],this.keyframeProps.color=[{frame:1,value:[255,255,255],tweenfn:null}],this.keyframeProps.intensity=[{frame:1,value:1,tweenfn:null}]);this.threeObj=new THREE.DirectionalLight(16777215,1);this.helper=new THREE.DirectionalLightHelper(this.threeObj,5);break;case 0:this.threeObj&&(CM.scene.remove(this.threeObj),this.threeObj=null,CM.scene.remove(this.helper),this.helper=null);return}CM.scene.add(this.helper);CM.scene.add(this.threeObj)},n.select=function(n){var t=this;if(this.objectType==0)PZeditor.generateButton({title:"Spot light",location:n,clickfn:function(){t.changeObjectType(1);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Point light",location:n,clickfn:function(){t.changeObjectType(2);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Directional light",location:n,clickfn:function(){t.changeObjectType(3);n.empty();t.select(n)}});else{PZeditor.generateButton({title:"Choose something else",back:!0,location:n,clickfn:function(){t.changeObjectType(0);n.empty();t.select(n)}});switch(t.objectType){case 1:PZeditor.generateTitle({title:"Spot light",location:n});PZeditor.generateTriInput({title:"Position",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.position,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateTriInput({title:"Target",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.target,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateColorPicker({title:"Color",color:"hsl(120, 50%, 50%)",keyframed:!0,tweens:!0,location:n,property:t.keyframeProps.color,hasalpha:!1});PZeditor.generateInput({title:"Intensity",color:"hsl(320, 50%, 50%)",location:n,keyframed:!0,tweens:!0,property:t.keyframeProps.intensity,vmax:100,vmin:0,vstep:1});PZeditor.generateInput({title:"Angle",color:"hsl(320, 50%, 50%)",location:n,keyframed:!0,tweens:!0,property:t.keyframeProps.angle,vmax:360,vmin:0,vstep:1});PZeditor.generateInput({title:"Exponent",color:"hsl(320, 50%, 50%)",location:n,keyframed:!0,tweens:!0,property:t.keyframeProps.exponent,vmax:1e3,vmin:0,vstep:1});break;case 2:PZeditor.generateTitle({title:"Point light",location:n});PZeditor.generateTriInput({title:"Position",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.position,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateInput({title:"Intensity",color:"hsl(320, 50%, 50%)",location:n,keyframed:!0,tweens:!0,property:t.keyframeProps.intensity,vmax:100,vmin:0,vstep:1});PZeditor.generateColorPicker({title:"Color",color:"hsl(120, 50%, 50%)",keyframed:!0,tweens:!0,location:n,property:t.keyframeProps.color,hasalpha:!1});break;case 3:PZeditor.generateTitle({title:"Directional light",location:n});PZeditor.generateTriInput({title:"Position",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.position,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateTriInput({title:"Target",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.target,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateColorPicker({title:"Color",color:"hsl(120, 50%, 50%)",keyframed:!0,tweens:!0,location:n,property:t.keyframeProps.color,hasalpha:!1});PZeditor.generateInput({title:"Intensity",color:"hsl(320, 50%, 50%)",location:n,keyframed:!0,tweens:!0,property:t.keyframeProps.intensity,vmax:100,vmin:0,vstep:1})}}CM.timelineObjects.objects=t.keyframeProps;CM.updateFrameUI()},n};CM.objects.add3dmodel=function(){var n={type:2,threeObj:null,objectType:0,keyframeProps:{position:[{frame:1,value:[0,0,0],tweenfn:null}],rotation:[{frame:1,value:[0,0,0],tweenfn:null}],scale:[{frame:1,value:[1,1,1],tweenfn:null}],opacity:[{frame:1,value:100,tweenfn:null}]}};return n.save=function(){return $.extend({},{type:this.type,objectType:this.objectType,keyframeProps:this.keyframeProps,normalProps:this.normalProps})},n.load=function(n){n?($.extend(!0,this,n),this.changeObjectType(this.objectType,!0)):this.changeObjectType(0)},n.unload=function(){this.threeObj&&CM.scene.remove(this.threeObj)},n.updateFrame=function(){if(this.threeObj){var n=TWEEN.getValue(this.keyframeProps.position,CM.currentFrame);this.threeObj.position.set(n[0],n[1],n[2]);n=TWEEN.getValue(this.keyframeProps.rotation,CM.currentFrame);this.threeObj.rotation.set(n[0]*Math.PI/180,n[1]*Math.PI/180,n[2]*Math.PI/180);n=TWEEN.getValue(this.keyframeProps.scale,CM.currentFrame);this.threeObj.scale.set(n[0],n[1],n[2]);this.threeObj.material.opacity=TWEEN.getValue(this.keyframeProps.opacity,CM.currentFrame)*.01}},n.center=function(){this.threeObj.geometry.computeBoundingBox();var t=this.threeObj.geometry.boundingBox,n=new THREE.Vector3;n.addVectors(t.min,t.max);n.multiplyScalar(-.5);switch(this.normalProps.positionMode){case 1:n.x-=n.x;break;case 2:n.x+=n.x;break;case 3:n.y+=n.y;break;case 4:n.y-=n.y;break;case 5:n.z+=n.z;break;case 6:n.z-=n.z}this.threeObj.geometry.applyMatrix((new THREE.Matrix4).makeTranslation(n.x,n.y,n.z));this.threeObj.geometry.computeBoundingBox()},n.changeObjectType=function(n,t){t||(this.normalProps={});this.objectType=n;switch(this.objectType){case 1:t||(this.normalProps.positionMode=0);var i=this,r=new THREE.JSONLoader;i.objectName="AK47";r.load("/legacy/im/preset_models/ak.js",function(n,t){i.threeObj=new THREE.Mesh(n,t[0]);i.threeObj.material.transparent=!0;CM.scene.add(i.threeObj);i.center()},"/legacy/im/preset_models/");break;case 0:this.threeObj&&(CM.scene.remove(this.threeObj),this.threeObj=null);return}},n.select=function(n){var t=this;this.objectType==0?PZeditor.generateButton({title:"AK47",location:n,clickfn:function(){t.changeObjectType(1);n.empty();t.select(n)}}):(PZeditor.generateButton({title:"Choose something else",back:!0,location:n,clickfn:function(){t.changeObjectType(0);n.empty();t.select(n)}}),PZeditor.generateTitle({title:t.objectName,location:n}),PZeditor.generateDropdown({title:"Center point",location:n,keyframed:!1,property:Number(t.normalProps.positionMode)+1,items:"center;left;right;top;bottom;front;back",updatefn:function(n){t.normalProps.positionMode=n-1;t.center()}}),PZeditor.generateTriInput({title:"Position",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.position,vmax:1e4,vmin:-1e4,vstep:1}),PZeditor.generateTriInput({title:"Rotation",color:"hsl(40, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.rotation,vmax:360,vmin:0,vstep:1}),PZeditor.generateTriInput({title:"Scale",color:"hsl(80, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.scale,vmax:1e3,vmin:0,vstep:1}),PZeditor.generateSpacer({location:n}),PZeditor.generateInput({title:"Opacity",color:"hsl(320, 50%, 50%)",location:n,keyframed:!0,tweens:!0,property:t.keyframeProps.opacity,vmax:100,vmin:0,vstep:1}));CM.timelineObjects.objects=t.keyframeProps;CM.updateFrameUI()},n};CM.objects.add3dshape=function(){var n={type:0,threeObj:null,objectType:0,keyframeProps:{position:[{frame:1,value:[0,0,0],tweenfn:null}],rotation:[{frame:1,value:[0,0,0],tweenfn:null}],scale:[{frame:1,value:[1,1,1],tweenfn:null}]}};return n.save=function(){return $.extend({},{type:this.type,objectType:this.objectType,keyframeProps:this.keyframeProps,normalProps:this.normalProps,appearanceObj:this.appearanceObj,appearanceObjData:this.appearanceObj?CM.appearance.objects[this.appearanceObj].save(this.threeObj.material):null})},n.load=function(n){n?($.extend(!0,this,n),this.changeObjectType(this.objectType,!0)):this.changeObjectType(0)},n.unload=function(){CM.appearance.unload(this.appearanceObj);this.threeObj&&CM.scene.remove(this.threeObj)},n.updateFrame=function(){if(this.threeObj){var n=TWEEN.getValue(this.keyframeProps.position,CM.currentFrame);this.threeObj.position.set(n[0],n[1],n[2]);n=TWEEN.getValue(this.keyframeProps.rotation,CM.currentFrame);this.threeObj.rotation.set(n[0]*Math.PI/180,n[1]*Math.PI/180,n[2]*Math.PI/180);n=TWEEN.getValue(this.keyframeProps.scale,CM.currentFrame);this.threeObj.scale.set(n[0],n[1],n[2]);this.threeObj.material}},n.center=function(){this.threeObj.geometry.computeBoundingBox();var t=this.threeObj.geometry.boundingBox,n=new THREE.Vector3;n.addVectors(t.min,t.max);n.multiplyScalar(-.5);switch(this.normalProps.positionMode){case 1:n.x-=n.x;break;case 2:n.x+=n.x;break;case 3:n.y+=n.y;break;case 4:n.y-=n.y;break;case 5:n.z+=n.z;break;case 6:n.z-=n.z}this.threeObj.geometry.applyMatrix((new THREE.Matrix4).makeTranslation(n.x,n.y,n.z));this.threeObj.geometry.computeBoundingBox()},n.updateProps=function(){this.threeObj.geometry.dispose();switch(this.objectType){case 1:this.threeObj.geometry=new THREE.BoxGeometry(this.normalProps.size[0],this.normalProps.size[1],this.normalProps.size[2]);break;case 2:this.threeObj.geometry=new THREE.CylinderGeometry(this.normalProps.size[0],this.normalProps.size[1],this.normalProps.size[2],this.normalProps.detail,1,this.normalProps.openEnded);break;case 3:this.threeObj.geometry=new THREE.PlaneGeometry(this.normalProps.size[0],this.normalProps.size[1]);break;case 4:this.threeObj.geometry=new THREE.CircleGeometry(this.normalProps.size,this.normalProps.detail,this.normalProps.thetaRange[0],this.normalProps.thetaRange[1]);break;case 5:this.threeObj.geometry=new THREE.SphereGeometry(this.normalProps.size,this.normalProps.detail[0],this.normalProps.detail[1],this.normalProps.thetaRange[0],this.normalProps.thetaRange[1],this.normalProps.phiRange[0],this.normalProps.phiRange[1]);break;case 6:this.threeObj.geometry=new THREE.TorusGeometry(this.normalProps.size[0],this.normalProps.size[1],this.normalProps.detail[0],this.normalProps.detail[1],this.normalProps.arc)}this.threeObj.geometry.buffersNeedUpdate=!0;this.center()},n.changeObjectType=function(n,t){t||(this.normalProps={});this.objectType=n;switch(this.objectType){case 1:t||(this.normalProps.size=[10,10,10],this.normalProps.tRepeat=[.05,.05],this.normalProps.positionMode=0);this.threeObj=new THREE.Mesh(new THREE.BoxGeometry(this.normalProps.size[0],this.normalProps.size[1],this.normalProps.size[2]),null);break;case 2:t||(this.normalProps.size=[5,5,10],this.normalProps.detail=10,this.normalProps.openEnded=!1,this.normalProps.tRepeat=[.05,.05],this.normalProps.positionMode=0);this.threeObj=new THREE.Mesh(new THREE.CylinderGeometry(this.normalProps.size[0],this.normalProps.size[1],this.normalProps.size[2],this.normalProps.detail,1,this.normalProps.openEnded),null);break;case 3:t||(this.normalProps.size=[10,10],this.normalProps.tRepeat=[.05,.05],this.normalProps.positionMode=0);this.threeObj=new THREE.Mesh(new THREE.PlaneGeometry(this.normalProps.size[0],this.normalProps.size[1]),null);break;case 4:t||(this.normalProps.size=5,this.normalProps.detail=20,this.normalProps.thetaRange=[0,Math.PI*2],this.normalProps.tRepeat=[.05,.05],this.normalProps.positionMode=0);this.threeObj=new THREE.Mesh(new THREE.CircleGeometry(this.normalProps.size,this.normalProps.detail,this.normalProps.thetaRange[0],this.normalProps.thetaRange[1]),null);break;case 5:t||(this.normalProps.size=5,this.normalProps.detail=[10,10],this.normalProps.thetaRange=[0,Math.PI*2],this.normalProps.phiRange=[0,Math.PI],this.normalProps.tRepeat=[.05,.05],this.normalProps.positionMode=0);this.threeObj=new THREE.Mesh(new THREE.SphereGeometry(this.normalProps.size,this.normalProps.detail[0],this.normalProps.detail[1],this.normalProps.thetaRange[0],this.normalProps.thetaRange[1],this.normalProps.phiRange[0],this.normalProps.phiRange[1]),null);break;case 6:t||(this.normalProps.size=[5,1],this.normalProps.detail=[10,10],this.normalProps.arc=Math.PI*2,this.normalProps.tRepeat=[.05,.05],this.normalProps.positionMode=0);this.threeObj=new THREE.Mesh(new THREE.TorusGeometry(this.normalProps.size[0],this.normalProps.size[1],this.normalProps.detail[0],this.normalProps.detail[1],this.normalProps.arc),null);break;case 0:this.threeObj&&(CM.scene.remove(this.threeObj),this.threeObj=null);CM.appearance.unload(this.appearanceObj);this.appearanceObj=null;return}this.center();this.threeObj.castShadow=!0;this.threeObj.receiveShadow=!0;this.appearanceObj||(this.appearanceObj="singlecolor");this.threeObj.material=CM.appearance.load(this.appearanceObj);this.appearanceObjData&&(CM.appearance.objects[this.appearanceObj].load(this.appearanceObjData,this.threeObj.material),delete this.appearanceObjData);CM.scene.add(this.threeObj)},n.select=function(n){var t=this,i;if(this.objectType==0)PZeditor.generateButton({title:"Box",location:n,clickfn:function(){t.changeObjectType(1);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Cylinder",location:n,clickfn:function(){t.changeObjectType(2);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Rectangle",location:n,clickfn:function(){t.changeObjectType(3);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Circle",location:n,clickfn:function(){t.changeObjectType(4);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Sphere",location:n,clickfn:function(){t.changeObjectType(5);n.empty();t.select(n)}}),PZeditor.generateButton({title:"Donut",location:n,clickfn:function(){t.changeObjectType(6);n.empty();t.select(n)}});else{PZeditor.generateButton({title:"Choose something else",back:!0,location:n,clickfn:function(){t.changeObjectType(0);n.empty();t.select(n)}});switch(this.objectType){case 1:PZeditor.generateTitle({title:"Box",location:n});PZeditor.generateTriInput({title:"Size",location:n,keyframed:!1,subtitle1:"width",subtitle2:"height",subtitle3:"depth",property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n,i){t.normalProps.size[i]=n;t.updateProps()}});break;case 2:PZeditor.generateTitle({title:"Cylinder",location:n});PZeditor.generateTriInput({title:"Size",location:n,keyframed:!1,subtitle1:"top radius",subtitle2:"bottom radius",subtitle3:"height",property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n,i){t.normalProps.size[i]=n;t.updateProps()}});PZeditor.generateInput({title:"Detail",location:n,keyframed:!1,property:t.normalProps.detail,vmax:1e4,vmin:0,vstep:1,updatefn:function(n){t.normalProps.detail=n;t.updateProps()}});PZeditor.generateDropdown({title:"Open ended",location:n,keyframed:!1,property:Number(t.normalProps.openEnded)+1,items:"false;true",updatefn:function(n){t.normalProps.openEnded=n==2?!0:!1;t.updateProps()}});break;case 3:PZeditor.generateTitle({title:"Rectangle",location:n});PZeditor.generateDualInput({title:"Size",location:n,keyframed:!1,subtitle1:"width",subtitle2:"height",property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n,i){t.normalProps.size[i]=n;t.updateProps()}});break;case 4:PZeditor.generateTitle({title:"Circle",location:n});PZeditor.generateInput({title:"Radius",location:n,keyframed:!1,property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n){t.normalProps.size=n;t.updateProps()}});PZeditor.generateInput({title:"Detail",location:n,keyframed:!1,property:t.normalProps.detail,vmax:1e4,vmin:1,vstep:1,updatefn:function(n){t.normalProps.detail=n;t.updateProps()}});break;case 5:PZeditor.generateTitle({title:"Sphere",location:n});PZeditor.generateInput({title:"Radius",location:n,keyframed:!1,property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n){t.normalProps.size=n;t.updateProps()}});PZeditor.generateDualInput({title:"Detail",location:n,keyframed:!1,subtitle1:"horizontal",subtitle2:"vertical",property:t.normalProps.detail,vmax:1e4,vmin:1,vstep:1,updatefn:function(n,i){t.normalProps.detail[i]=n;t.updateProps()}});break;case 6:PZeditor.generateTitle({title:"Donut",location:n});PZeditor.generateDualInput({title:"Size",location:n,keyframed:!1,subtitle1:"radius",subtitle2:"tube radius",property:t.normalProps.size,vmax:1e4,vmin:0,vstep:1,updatefn:function(n,i){t.normalProps.size[i]=n;t.updateProps()}});PZeditor.generateDualInput({title:"Detail",location:n,keyframed:!1,subtitle1:"inner",subtitle2:"outer",property:t.normalProps.detail,vmax:1e4,vmin:1,vstep:1,updatefn:function(n,i){t.normalProps.detail[i]=n;t.updateProps()}})}PZeditor.generateSpacer({location:n});PZeditor.generateDropdown({title:"Center point",location:n,keyframed:!1,property:Number(t.normalProps.positionMode)+1,items:"center;left;right;top;bottom;front;back",updatefn:function(n){t.normalProps.positionMode=n-1;t.updateProps()}});PZeditor.generateTriInput({title:"Position",color:"hsl(0, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.position,vmax:1e4,vmin:-1e4,vstep:1});PZeditor.generateTriInput({title:"Rotation",color:"hsl(120, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.rotation,vmax:360,vmin:0,vstep:1});PZeditor.generateTriInput({title:"Scale",color:"hsl(240, 50%, 50%)",location:n,keyframed:!0,tweens:!0,subtitle1:"X",subtitle2:"Y",subtitle3:"Z",property:t.keyframeProps.scale,vmax:1e3,vmin:0,vstep:1});PZeditor.generateSpacer({location:n});PZeditor.generateDropdown({location:n,title:"Appearance",keyframed:!1,property:t.appearanceObj?CM.appearance.list[t.appearanceObj].index+1:1,items:CM.appearance.string,updatefn:function(n){CM.appearance.unload(t.appearanceObj);var r=0;for(prop in CM.appearance.list)if(r++,r==n){t.appearanceObj=prop;break}t.threeObj.material&&t.threeObj.material.dispose();t.threeObj.material=CM.appearance.load(t.appearanceObj);i.empty();CM.appearance.objects[t.appearanceObj].select(i,t.threeObj.material)}});i=PZeditor.generatePlaceholder({location:n});CM.appearance.objects[t.appearanceObj].select(i,t.threeObj.material)}CM.timelineObjects.objects=t.keyframeProps;CM.updateFrameUI()},n};